<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>fletchers-cloud-blog/posts/2021/bicep-troubleshooting/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://cloud.fskelly.com/hugo-theme-console/css/terminal-0.7.4.min.css">
    <link rel="stylesheet" href="https://cloud.fskelly.com/hugo-theme-console/css/animate-4.1.1.min.css">
    <link rel="stylesheet" href="https://cloud.fskelly.com/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Bicep Troubleshooting" />
<meta property="og:description" content="A quick post to help with a common &#39;error&#39; I run into now and then." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloud.fskelly.com/posts/2021/bicep-troubleshooting/" /><meta property="article:published_time" content="2021-07-02T05:40:16+02:00" />



<meta name="twitter:title" content="Bicep Troubleshooting"/>
<meta name="twitter:description" content="A quick post to help with a common &#39;error&#39; I run into now and then."/>

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://cloud.fskelly.com/" class="no-style site-name">fletchers-cloud-blog</a>:~# 
              <a href='https://cloud.fskelly.com/posts'>posts</a>/<a href='https://cloud.fskelly.com/posts/2021'>2021</a>/<a href='https://cloud.fskelly.com/posts/2021/bicep-troubleshooting'>bicep-troubleshooting</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://cloud.fskelly.com/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="https://cloud.fskelly.com/posts/" typeof="ListItem">posts/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated zoomIn fast" >
        
<h1>Bicep Troubleshooting</h1>

Jul. 2, 2021


<br/><br/>
<h1 id="some-basic-troubleshooting-with-azure-bicephttpsdocsmicrosoftcomen-usazureazure-resource-managerbicepoverview">Some basic &ldquo;troubleshooting&rdquo; with <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/overview">Azure Bicep</a></h1>
<p>So, let me start with this. The team and the community behind Azure Bicep are amazing. There are some great examples <a href="https://github.com/Azure/bicep">here</a>. I often use these as a base and the rip apart or add to meet my needs, you do <strong>NOT</strong> need to start from ground zero. :smile:</p>
<p>When you are deploying bicep templates you command will look something like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$bicepFile = <span style="color:#e6db74">&#34;.\main.bicep&#34;</span>
</span></span><span style="display:flex;"><span>New-AzResourceGroupDeployment -ResourceGroupName &lt;resourceGroupName&gt; -TemplateFile &lt;bicepFilePath&gt; -name &lt;deploymentname&gt;
</span></span></code></pre></div><p>I love to use repeatable code, so mine has more variables and would look like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e">## Place Resource Group Name here</span>
</span></span><span style="display:flex;"><span>$rgName = <span style="color:#e6db74">&#34;testingRG&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## add tags if you want to add metadata</span>
</span></span><span style="display:flex;"><span>$tags = @{<span style="color:#e6db74">&#34;deploymentMethod&#34;</span>=<span style="color:#e6db74">&#34;bicep&#34;</span>; <span style="color:#e6db74">&#34;Can Be Deleted&#34;</span>=<span style="color:#e6db74">&#34;yes&#34;</span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">## location to be deployed into</span>
</span></span><span style="display:flex;"><span>$rgLocation = <span style="color:#e6db74">&#34;westeurope&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#use this command when you need to create a new resource group for your deployment</span>
</span></span><span style="display:flex;"><span>$rg = New-AzResourceGroup -Name $rgName -Location $rgLocation 
</span></span><span style="display:flex;"><span>New-AzTag -ResourceId $rg.ResourceId -Tag $tags
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## bicep Deployment</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Bicep File name</span>
</span></span><span style="display:flex;"><span>$bicepFile = <span style="color:#e6db74">&#34;.\main.bicep&#34;</span>
</span></span><span style="display:flex;"><span>$deploymentName = ($bicepFile).Substring(<span style="color:#ae81ff">2</span>) + <span style="color:#e6db74">&#34;-&#34;</span> +(get-date -Format ddMMyyyy-hhmmss) + <span style="color:#e6db74">&#34;-deployment&#34;</span>
</span></span><span style="display:flex;"><span>New-AzResourceGroupDeployment -ResourceGroupName $rgName -TemplateFile $bicepFile -name $deploymentName
</span></span></code></pre></div><p>When trying to deploy you might get an error like this.
<img src="https://github.com/fskelly/flkelly-cloudblog/blob/main/static/images/blogImages/2021/biceptroubleshooting/bicepError.png?raw=true" alt="deployment errors"></p>
<p>And that is very cryptic and <strong>NOT</strong> easy to understand. The easiest fix here is to go back to basics. :smile:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>az bicep build -<span style="color:#f92672">-file</span> .\main.bicep
</span></span></code></pre></div><p>This will then throw the actual bicep error, and then you can fix your file and deploy again.</p>
<p>Hope this helps you.</p>



        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a> with
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
</div>

    </div>
  </body>
</html>
